---
layout: post
title: "ucore lab1"
subtitle: '清华大学操作系统实验 ucore 实验一'
author: "Tang Jibin"
header-img: img/header/2021-11-22-lab-blog.png #不需要加图片就用 header-img: text
#header-img-credit: CG #在图片右下角加 credit
header-mask: 0.5 #表示图片的阴影指数，只在标题加图片才需要
hidden: false
mathjax: false
mermaid: false
tags:
  - OS
  - ucore
  - Lab
---

## 练习1：理解通过make生成执行文件的过程



### 2.一个被系统认为是符合规范的硬盘主引导扇区的特征是什么？

我们可以发现在 `make` 后，在 bin 文件夹下生成了一个 `sign` 文件，这个文件就是用来检测是否符合规范的硬盘主引导扇区的

我们在 `Makefile` 文件里找到生成 `sign` 的相关代码：

```makefile
# create 'sign' tools
$(call add_files_host,tools/sign.c,sign,sign)
$(call create_target_host,sign,sign)
```

我们可以发现， `sign` 文件是由 tools 文件夹里的 `sign.c` 生成的，仔细观察 `sign.c` 的代码，我们可以发现这么几段

```c
if (st.st_size > 510) {
    fprintf(stderr, "%lld >> 510!!\n", (long long)st.st_size);
    return -1;
}

buf[510] = 0x55;
buf[511] = 0xAA;

if (size != 512) {
    fprintf(stderr, "write '%s' error, size is %d.\n", argv[2], size);
    return -1;
}
```

根据这里我们可以知道，硬盘主引导扇区里的程序不能超过 510 个字节，硬盘主引导扇区大小必须为 512 个字节，并且最后两个字节一定要分别是 0x55 和0xAA



